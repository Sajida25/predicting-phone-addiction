---
title: "Visuals"
format: html
execute:
  echo: false
  warning: false
  message: false
---

## Waffle Chart: Teen Smartphone Addiction Ratio

```{r}
library(ggplot2)
library(waffle)
library(dplyr)
library(readr)
library(hrbrthemes)

# Load the dataset
data <- read_csv("C:/Users/user/Desktop/projects/teen_phone_addiction_dataset.csv")

# Create a binary variable
data <- data |>
  mutate(addicted = if_else(Addiction_Level >= 8, "Addicted", "Not Addicted"))

# Count and prepare proportions
counts <- data |>
  count(addicted) |>
  mutate(prop = round(n / sum(n) * 100))

waffle_data <- setNames(counts$prop, counts$addicted)

# Create the waffle chart
waffle(
  parts = waffle_data,
  rows = 10,
  colors = c("#B388EB", "#FFB6C1"),
  size = 1.3,
  title = "Teen Smartphone Addiction: Proportion Chart",
  xlab = "Each square = 1% of teens"
) +
  theme_ipsum(base_family = "TT Arial", base_size = 14) +
  theme(
    plot.title = element_text(size = 20, face = "bold", hjust = 0.5, color = "#4A148C"),
    axis.title = element_text(size = 12),
    legend.position = "bottom"
  )
```

## Interpretation

This waffle chart visualizes the **proportion of teenagers** who are addicted to their smartphones (Addiction_Level â‰¥ 8).

- Each square represents **1%** of the dataset.
- **Purple** squares = teens classified as **Addicted**.
- **Pink** squares = teens classified as **Not Addicted**.

### Key Insight:

A **majority of teens in the dataset are addicted**. This suggests that smartphone dependency is a serious concern and may require interventions from parents, teachers, and health professionals.

---

##  3D Surface Plot: Addiction Probability by Usage & Social Media Time

```{r}
library(plotly)

# Prepare binary outcome
data <- data |>
  mutate(addicted = if_else(Addiction_Level >= 8, 1, 0))

# Fit logistic regression
model <- glm(
  addicted ~ Daily_Usage_Hours + Time_on_Social_Media + Sleep_Hours + Anxiety_Level + Depression_Level,
  data = data,
  family = "binomial"
)

# Create prediction grid
grid <- expand.grid(
  Daily_Usage_Hours = seq(min(data$Daily_Usage_Hours), max(data$Daily_Usage_Hours), length.out = 50),
  Time_on_Social_Media = seq(min(data$Time_on_Social_Media), max(data$Time_on_Social_Media), length.out = 50)
)

# Hold other vars constant
grid$Sleep_Hours <- median(data$Sleep_Hours, na.rm = TRUE)
grid$Anxiety_Level <- median(data$Anxiety_Level, na.rm = TRUE)
grid$Depression_Level <- median(data$Depression_Level, na.rm = TRUE)

# Predict probabilities
grid$prob <- predict(model, newdata = grid, type = "response")
z_matrix <- matrix(grid$prob, nrow = 50, byrow = TRUE)

# Generate 3D plot
plot_ly(
  x = ~unique(grid$Daily_Usage_Hours),
  y = ~unique(grid$Time_on_Social_Media),
  z = ~z_matrix,
  type = "surface",
  colorscale = "Viridis"
) |>
  layout(
    title = "3D Surface: Addiction Probability",
    scene = list(
      xaxis = list(title = "Daily Usage Hours"),
      yaxis = list(title = "Time on Social Media"),
      zaxis = list(title = "Probability of Addiction")
    )
  )
```

###  Interpretation

This 3D surface plot shows how **Daily Phone Usage Hours** and **Time on Social Media** affect the predicted probability of smartphone addiction.


- **X-axis:** Daily phone use (in hours)
- **Y-axis:** Time on social media (in hours)
- **Z-axis (color & height):** Probability of being addicted

###  Key Insight:

As both **screen time** and **social media time** increase, the **risk of addiction sharply rises**. Teens who use their phones heavily and spend more time on social platforms are much more likely to fall into the "Addicted" category.

---

##  Summary of Visual Insights

1. **Waffle Chart** shows that a **majority** of teens in the dataset are addicted.
2. **3D Surface Plot** reveals that addiction probability **increases sharply** with more screen and social media use.
3. These insights can guide **awareness campaigns**, **parental monitoring**, and **mental health programs** targeting smartphone usage among teenagers.
